---
title: "Playful iconicity: relating iconicity and humor ratings for English words"
author: "Mark Dingemanse"
date: "`r format(Sys.Date())`"
output: github_document
---

People have feelings about the funniness of words. They can express these feelings in terms of word-level ratings. In a recent set of word-level norms, Engelthaler & Hills 2017 claim that these ratings are "not well predicted by existing norms". The highest correlations they find are between humor ~ frequency and humour ~ lexical decision RT. 

However, humor ratings do not occur in a vacuum: presumably subjects are using some information when judging how funny a word is. The most directly available information would be the phonological form of the word and the relation it presents between form and meaning. This leads to the prediction that measures that tap into that should correlate with humor ratings. Here we test the prediction that *iconicity ratings will be positively correlated with humor ratings, controlling for frequency.*

The theoretical interest here is that people working on iconic words have long drawn attention to their expressive and playful nature. According to Fortune (1960), ideophones "bring a sense of ease and mirth". Welmers (1973) defines them as "those words which are such fun to use" and Samarin (1970) notes that ideophones "display a great deal of play with sounds". In my own fieldwork, I noted that "Mawu children may tease the white researcher living in their village by imitating his way of walking and by singing a song mocking his red skin (pɛ̃ɛ̃), small eyes (tsiritsiri), and pointy nose (miɔmiɔ) — all ideophones" (Dingemanse 2011:83).

If there is indeed a link between iconicity and the subjective funnyness of words, this solidifies a relationship that has has so far been based mainly on anecdotal observations and studies of relatively small numbers of words.

Outliers (words where ratings disagree most) help to discover other features at play. E.g. 'blonde' is in the top 10 percentile of funny words but only in the 2nd percentile of iconicity ratings. Probably related to a genre of jokes. On the other hand, some onomatopoeia are highly iconic but associated with negative rather than with funny events, e.g. 'crash', 'scratch','roar', 'clash', pointing to the importance of valence and arousal more generally.

```{r preliminaries}

# Clear workspace
rm(list=ls())

# check for /in/ and /out/ directories (create them if needed)
add_working_dir <- function(x) { if(file.exists(x)) { cat(x,"dir:",paste0(getwd(),"/",x,"/")) } else { dir.create(paste0(getwd(),"/",x)) 
  cat("subdirectory",x,"created in",getwd()) } }
add_working_dir("in")
add_working_dir("out")

# Packages and useful functions
list.of.packages <- c("tidyverse","GGally","ggthemes","readxl","lme4","ppcor")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)>0) install.packages(new.packages)
lapply(list.of.packages, require, character.only=T)
rm(list.of.packages,new.packages)

`%notin%` <- function(x,y) !(x %in% y) 

```
# Load data

Data sources:
* Perry, Lynn K. et al. “Iconicity in the Speech of Children and Adults.” Developmental Science, n/a-n/a. doi:10.1111/desc.12572.
* Engelthaler, Tomas, and Thomas T. Hills. 2017. “Humor Norms for 4,997 English Words.” Behavior Research Methods, July, 1–9. doi:10.3758/s13428-017-0930-6.

```{r data}
iconicity <- read_csv("https://raw.githubusercontent.com/bodowinter/iconicity_acquisition/master/data/iconicity.csv") %>%
  mutate(POS = SUBTLEX_dom_POS) %>%
  plyr::rename(c("Word" = "word","Iconicity"="iconicity","OrthoLength"="len_ortho","SUBTLEX_Rawfreq" = "freq_count"))

humor <- read_csv("https://raw.githubusercontent.com/tomasengelthaler/HumorNorms/master/humor_dataset.csv") %>%
  plyr::rename(c("mean" = "humor"))

df <- merge(iconicity,humor,by="word") %>%
  drop_na(iconicity,humor,freq_count) %>%
  mutate(freq_log = log(freq_count))

# Combine humor with predicted iconicity ratings from Bill and frequency / POS data from SUBTLEX
p.ico <- read_csv("in/ipennl.csv") %>%
  filter(language=="en") %>%
  dplyr::select(Word,Concreteness,Iconicity_PREDICTED)
names(p.ico) <- tolower(names(p.ico))

subtlex <- read_excel(path="in/SUBTLEX-US frequency list with PoS and Zipf information.xlsx") %>%
  plyr::rename(c("Word" = "word","FREQcount" = "freq_count","Lg10WF" = "freq_log","Dom_PoS_SUBTLEX" = "POS")) %>%
  dplyr::select(word,freq_log,POS) %>%
  filter(word %in% p.ico$word)

df_pred <- humor %>%
  left_join(p.ico) %>%
  drop_na(humor,iconicity_predicted) %>%
  left_join(df) %>%
  dplyr::select(-POS,-freq_log) %>%
  left_join(subtlex) %>% 
  drop_na(freq_log,POS) %>%
  mutate(set = ifelse(is.na(iconicity),"unrated","rated")) # indicate subsets

```

# Plots
First eyeball data. Iconicity looks a pretty good predictor in addition to frequency, which was the best predictor according to Engelthaler & Hills (2017). Humor shows a positive correlation with iconicity rating, as predicted. The relation is strongest for iconicity ratings >0, indicating that some anti-iconic words may be moderately more funny (or at least not less funny).

```{r plots}

summary(lm(humor ~ freq_log + iconicity, df))

ggplot(df,aes(humor,freq_log)) +
  theme_tufte() + ggtitle("Humor ratings by log frequency") + 
  geom_point(alpha=0.5) +
  geom_smooth(method="auto")
ggsave(file="out/humor_by_iconicity.png",width=6,height=4)

ggplot(df,aes(humor,iconicity)) +
  theme_tufte() + ggtitle("Humor ratings by iconicity") + 
  geom_point(alpha=0.5) +
  geom_smooth(method="loess")
ggsave(file="out/humor_by_iconicity.png",width=6,height=4)

```

Let's residualise out `log_freq` so we get a better look at the humor ~ iconicity relation; and conversely, residualise `iconicity` to look at humor ~ frequency. 

Is that a .07 increase in humor for every +1 in iconicity?

```{r residualising1}

summary(lm(humor ~ freq_log + iconicity,df))

df$residuals <- residuals(lm(humor ~ freq_log,df))
ggplot(df,aes(humor,residuals)) +
  theme_tufte() + ggtitle("Humor ratings, frequency residualised out") + 
  geom_point(shape=16,alpha=0.5) +
  geom_smooth(method="lm")
ggsave(file="out/humor_residualised_logfreq.png",width=6,height=4)

df$residuals <- residuals(lm(humor ~ iconicity,df))
ggplot(df,aes(humor,residuals)) +
  theme_tufte() + ggtitle("Humor ratings, iconicity residualised out") + 
  geom_point(shape=16,alpha=0.5) +
  geom_smooth(method="lm")
ggsave(file="out/humor_residualised_iconicity.png",width=6,height=4)


```

Now look at Bill's predicted iconicity ratings. To avoid double-dipping we tease apart words for which the predictions overlap with the ratings (n=1391) and words for which predictions are newly inferred (n=3242) (encoded in `$set`). 

Predicted iconicity values correlate with humor ratings even when controlling for frequency. For every point gained in predicted iconicity there's a .21 increase in humor rating.

```{r iconicity_predicted}

summary(lm(humor ~ freq_log + iconicity_predicted,df_pred))

ggplot(df_pred,aes(iconicity_predicted,humor)) +
  geom_point(shape=16,alpha=0.5) +
  geom_smooth(method="lm") +
  facet_wrap(~set)
```
And here too we can residualise out `freq_log` to get a better view of the relation:

```{r residualising2}

summary(lm(humor ~ freq_log + iconicity_predicted,df_pred))

df_pred$residuals <- residuals(lm(humor ~ freq_log,df_pred))
ggplot(df_pred,aes(humor,residuals)) +
  geom_point(shape=16,alpha=0.5) +
  geom_smooth(method="lm") +
  facet_wrap(~ set)
ggsave(file="out/humor_by_iconicity_predicted_logfreq_residualised.png",width=6,height=4)

```

# Stats
LME with orthographic length as a random effect shows that although log frequency is an important predictor of word funnyness, a model including iconicity in addition to log frequency provides a significantly better fit.

```{r stats}
m0 <- lmer(humor ~ freq_log + (1|len_ortho),data=df)
m1 <- lmer(humor ~ freq_log + iconicity + (1|len_ortho),data=df)
m2 <- lmer(humor ~ iconicity + (1|len_ortho),data=df)

m0
m1
anova(m0,m1)
```

Partial correlations show there is 20.6% covariance between humor and iconicity, partialing out log frequency as a mediator. There is -35.7% covariance between humor and frequency, partialing out iconicity as a mediator (the more frequent a word, the less funny). A -9.5% correlation between iconicity and frequency when partialing out humor. (Winter et al. 2017 report a negative correlation between iconicity and frequency.)

```{r}
pcor.test(x=df$humor,y=df$iconicity,z=df$freq_log)
pcor.test(x=df$humor,y=df$freq_log,z=df$iconicity)
pcor.test(x=df$iconicity,y=df$freq_log,z=df$humor)
```

# Words
Which words are rated as highly funny but not iconic, or vice versa? And what are the words rated high on both dimensions?

```{r words}
df <- df %>% 
  mutate(humor_perc = ntile(humor,10)) %>%
  mutate(iconicity_perc = ntile(iconicity,10))

# rated as funny but not iconic
df %>% 
  filter(humor_perc > 9, iconicity_perc < 4) %>%
  arrange(iconicity) %>%
  dplyr::select(word,humor,humor_perc,iconicity,iconicity_perc)

# rated as iconic but not funny
df %>% 
  filter(iconicity_perc > 9, humor_perc < 4) %>%
  arrange(humor) %>%
  dplyr::select(word,humor,humor_perc,iconicity,iconicity_perc) %>%
  slice(1:20)

# Which words are rated as very iconic AND very funny?
df %>%
  filter(iconicity_perc >9,humor_perc >9) %>%
  arrange(desc(iconicity)) %>%
  dplyr::select(word,humor,humor_perc,iconicity,iconicity_perc)
```

# References
* Dingemanse, Mark. 2011. “Ideophones and the Aesthetics of Everyday Language in a West-African Society.” The Senses and Society 6 (1): 77–85. doi:10.2752/174589311X12893982233830.
* Fortune, G. 1962. Ideophones in Shona: An Inaugural Lecture Given in the University College of Rhodesia and Nyasaland on 28 April 1961. London / New York: Oxford University Press.
* Samarin, William J. 1970. “Inventory and Choice in Expressive Language.” Word 26: 153–69.
* Welmers, William E. 1973. African Language Structures. Berkeley: University of California Press.
* Winter, Bodo et al. 2017. “Which Words Are Most Iconic? Iconicity in English Sensory Words.” Interaction Studies.
